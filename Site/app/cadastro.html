<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cadastro</title>
    <link rel="stylesheet" href="./cadastro.css" />
  </head>
  <body>
    <header class="navbar">
    <div class="logo">
      <img src="./Imgs/ICONE.png" alt="Cosmos Tech Logo">
      <span>
        <span class="cosmos">COSMOS</span>
        <span class="tech">TECH</span>
      </span>
    </div>

    <nav class="menu">
      <a href="./index.html"> Início</a>
      <a href="./login.html">Login</a>
      <a class="active" href="./cadastro.html">Cadastro</a>
    </nav>
  </header>

    <div class="video-container">
      <video autoplay loop muted>
        <source src="./video/215695_medium.mp4" />
      </video>
    </div>

    <main class="content">
      <div class="cadastro">
        <h2>Cadastro</h2>

        <label for="nome">Digite seu nome</label>
        <input id="ipt_nome" type="text" placeholder="Seu nome" />

        <label for="email">Digite seu e-mail</label>
        <input id="ipt_email" type="email" placeholder="Seu e-mail" />

        <label for="senha">Digite sua senha</label>
        <input id="ipt_senha" type="password" placeholder="Sua senha" />

        <label for="confirmar">Confirme sua senha</label>
        <input
          id="confirmar"
          type="password"
          placeholder="Confirme sua senha"
        />
        
        <div style="color: rgb(32, 32, 32); font-size: 15px;font-weight: 700;" id="div_alert"></div>
        <button onclick="cadastra()"> Cadastrar </button>
      </div>
    </main>
  </body>
</html>
<script>
  function cadastra() {
    var nome = ipt_nome.value;
    var email = ipt_email.value;

    var senha = ipt_senha.value;
    var conf = confirmar.value;

    if(nome== ''|| email == ''|| senha == ''|| conf ==''){
      div_alert.innerHTML=('Informe todos os dados')

    }
    else{

      if(senha !== conf){
        div_alert.innerHTML=('A confirmação da sua senha precias ser igual a senha')
      }
      else{
       // Enviando o valor da nova input
    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: nome,
        emailServer: email,
        senhaServer: senha
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {

          div_alert.innerHTML=(
            "Cadastro realizado com sucesso! Redirecionando para tela de Login...");

          setTimeout(() => {
            window.location.href = "login.html";
          }, "2000");

        } else {
          div_alert.innerHTML( "Houve um erro ao tentar realizar o cadastro!");
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
      });

    return false;
  }
    }

  }
  
</script>
